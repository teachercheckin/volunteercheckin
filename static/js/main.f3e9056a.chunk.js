(this.webpackJsonpcheckinout=this.webpackJsonpcheckinout||[]).push([[0],{128:function(e,t){},134:function(e,t,n){},20:function(e){e.exports=JSON.parse('{"loading":"Loading in progress...","noSheet":"\u2757 Could not find spreadsheet with today\'s date!","reloadPage":"Please create the spreadsheet for today and reload the app to check in!","loaded":"\u2705 Ready to check in!","noStudent":"\u2757 Student ID could not be found!","checkIn":"\ud83d\udc4b Checked in {0} at {1}!","checkOut":"\ud83d\udeaa Checked out {0} at {1}!","alreadyDone":"\ud83d\udfe1 {0} is already accounted for!","failedToOpen":"\u2757 Could not find data to use.","succeededToOpen":"\u2705 Found ID data."}')},247:function(e){e.exports=JSON.parse('{"type":"service_account","project_id":"aattendance","private_key_id":"e2e0a85f1955997624e83a711ca5c6626dbdd9a9","private_key":"-----BEGIN PRIVATE KEY-----\\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCaXjj+dxM7gRMh\\n33Ivo5/2OWXUZiRHLUYQZnOqt+U2E56ljPKbxkNSsW1d9Cjh7b4zvsG7RdsUabOx\\nWVChGm1Z4VVXGc5D69epXry+FhEmAMX/Clq+k6k0bomLYnhbdOJQSK0L1GP9rbDM\\ndTg5MwafHXLxLQa+24SlY35YY6GW9hdcJydzXijdN2GiJ6n18l5k+hOxZlJP45Th\\nw298wvGirTjcPruTsJctMIQADEiaW9uLA5d0OTEDsrZILXEJyXk97KKO7a6iaX1N\\nDeIudEU11/VB/YbZ/LxJWd6JXOoOToBI9mgFow5qLrF9ve/rW5qK5IZd6AMORm14\\nEJQVcNKXAgMBAAECggEAMThm4thT5Q7Aa3YEQiVhjVB65BEXcyx/4R3RtrcBGk+C\\nL9YzyzCZ6cWSEjmWSYeVNImX2x8ofic/+QX5/Axhnp2HKQkc6DJMZwBCnTeLCzuG\\n5k3GZmrNsl6mc6+Xoc2wlZm+t31mzo2xyFd98FsROu3YZwcM1hFHh7akJAnMjcX1\\n8xEgdjM2H64YXVo6yTSk1/N1Nid3tENyPcKV50jqeBiePfEhVEFKztKJag0ue5Ez\\noKsuqDSGcAB1qZ04EXiKbM7Ut8nZI+lXU3LRyOhi068Xm6tSn639PY7TIb66kW3X\\nDLAxShKImP/E+goXNF5LrdeLrKQhf3x4s5FDFoRKtQKBgQDRzw2kSlpNkA2xS8bl\\nl3ekugZtvUCzu6d+ic5dzuviNnMjom6TNbVPUt9Xzdnz9B+YYWRKTTvANmPECjcN\\nxm8kZRYR8WIBy9QJ3esEI/9cJli/kAJPAG+LXUVZHaGhHWJs4KWAJ0wIuojANkoQ\\nFHToD/JeVKpUr0Dv1ehuFJJBJQKBgQC8Wn8e3ubBxA4B6Q5r1svAd0FtTFnVlrOQ\\nTfAvYgJuaNzqycMht1/j2pHzx6GhF3YwKcDT9kv3hKfsFcf1/UCLbryJoxgsygIu\\nM3RSB3cjHdG0E/bqHjwMbSLQyxmeadO1iPMIqSrRrLpfAAeBpjXLVFWoWvslISk/\\nqwoFjbgOCwKBgQCUxxesXdFFWRZsmAiVvF/qHsP6Q47DJRm0AHKnUNkyU1w4c7Gn\\nkBlfA6w+7klU1dMl0kI08imhtq/uTzQU/5bGnywUUzAlh+13hbdm+0PUi5i5Vpxc\\nezmeAOjxNbLsthKalH6nrrYbJnNcoeLJHkh8WvqKa81ROel5aR1mGg5QRQKBgAUi\\nxpKV617fNK6Sp0UDf1zJI6ySR2TOjijiJylzl7NhAp0YUUzLDj9NR2uJRvv4gs1/\\nZfWhoqKmKFoEogYwGKF0rIloPBGElJij6IkQEQyRFJW/cZ0io+qG00s0LoemRRKP\\nIGldC4DaH97VRl8fpBneO9OyX2S8yb4lsMlD+v/PAoGAANwBvYWbv6gA3pXYGCtb\\nodMFDwG5biM9v1wHz6KdqVNcMiFxuIZO6xvAUKyMduBuNKxXKgmiH7x5gSy7Z7HC\\n/bewYsKuNtZFR4xr8tjbyWV7azWrd8j9Od6PSMRgRdSZZ1xLwKFBg+VUPrGnoyHL\\naeG7ZEZnUgIiIFx3C4Vc2Tk=\\n-----END PRIVATE KEY-----\\n","client_email":"attandance@aattendance.iam.gserviceaccount.com","client_id":"102650935585906924799","auth_uri":"https://accounts.google.com/o/oauth2/auth","token_uri":"https://oauth2.googleapis.com/token","auth_provider_x509_cert_url":"https://www.googleapis.com/oauth2/v1/certs","client_x509_cert_url":"https://www.googleapis.com/robot/v1/metadata/x509/attandance%40aattendance.iam.gserviceaccount.com","universe_domain":"googleapis.com"}')},253:function(e,t,n){},277:function(e,t){},279:function(e,t){},297:function(e,t){},333:function(e,t){},335:function(e,t){},367:function(e,t){},369:function(e,t){},370:function(e,t){},375:function(e,t){},377:function(e,t){},383:function(e,t){},385:function(e,t){},404:function(e,t){},416:function(e,t){},419:function(e,t){},45:function(e){e.exports=JSON.parse('{"name":["Name","name","\uc774\ub984"],"id":["ID"],"class":["Class","\ud559\uae09"],"grade":["Grade","\ud559\ub144/\uc131\ubcc4"],"checkIn":["Check in"],"checkOut":["Check out"],"absence":["Absence","\uacb0\uc11d \ubc30\uc815"],"total":["Total"],"print":["Print","print"]}')},468:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),a=n(67),i=n.n(a),s=(n(253),n(3)),o=n(7),u=(n(134),n(22)),d=n(6),l=n(19),h=n(12),b=(n(254),n(245)),f=n.n(b),j=n(1),p=0;var O=function(e){var t=Object(c.useRef)(),n=Object(c.useRef)(),r=Object(c.useState)(),a=Object(d.a)(r,2),i=a[0],s=a[1],o=Object(c.useState)(!1),u=Object(d.a)(o,2),l=u[0],h=u[1];function b(){if(e.periodic()&&(h(!0),setTimeout((function(){h(!1)}),300)),!(--p>0))if(t&&t.current&&t.current.readyState===t.current.HAVE_ENOUGH_DATA){n.current.height=t.current.videoHeight,n.current.width=t.current.videoWidth;var c=n.current.getContext("2d");c.drawImage(t.current,0,0,n.current.width,n.current.height);var r=c.getImageData(0,0,n.current.width,n.current.height),a=f()(r.data,r.width,r.height,{inversionAttempts:"dontInvert"});a&&(console.log(a.data),s({data:a.data,time:new Date}),p=5)}else;}return Object(c.useEffect)((function(){i&&(e.onScan(i.data),s(null))}),[i]),Object(c.useEffect)((function(){var e=!0,t=setInterval((function(){e?requestAnimationFrame(b):console.log("Unmounted reader call")}),200);return function(){console.log("Clear interval for reader"),e=!1,clearInterval(t)}}),[]),Object(c.useEffect)((function(){navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}).then((function(e){console.log(e);try{t.current.srcObject=e,t.current.setAttribute("playsinline",!0),t.current.play()}catch(n){}}))}),[t,n]),Object(j.jsxs)("div",{children:[Object(j.jsx)("video",{style:{filter:l?"brightness(0%)":"brightness(100%)"},ref:t}),Object(j.jsx)("canvas",{ref:n,hidden:!0})]})},v=24,x=function(e){return new Promise((function(t){return setTimeout(t,Math.ceil(1e3*e))}))};String.prototype.format=function(){for(var e=this,t=0;t<arguments.length;t++){var n=new RegExp("\\{"+t+"\\}","gi");e=e.replace(n,arguments[t])}return e};var g={position:"top-center",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0},m=(n(92),n.p+"static/media/Logo.f0526f33.png"),k=n(20),S=[],y=[],C=[],w=!1,I=0;var E=function(e){var t=Object(c.useState)((new Date).toLocaleDateString()),n=Object(d.a)(t,2),r=n[0],a=n[1],i=Object(c.useState)(""),b=Object(d.a)(i,2),f=b[0],p=b[1];function v(){return(v=Object(o.a)(Object(s.a)().mark((function e(t){var n,c;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(new Date).getTime(),console.log("reached function "+n+" "+t),(c=parseInt(t))>0&&S.push({tick:n,id:c}),e.abrupt("return");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(){var e=Object(j.jsxs)("tr",{children:[Object(j.jsx)("th",{id:"name",children:"Name"}),Object(j.jsx)("th",{id:"action",children:"action"}),Object(j.jsx)("th",{id:"time",children:"time"})]});return Object(j.jsx)("table",{children:Object(j.jsxs)("tbody",{children:[e,C.map((function(e){return Object(j.jsxs)("tr",{children:[Object(j.jsx)("td",{id:"name",children:e[1]},"name"),Object(j.jsx)("td",{id:"action",children:e[2]},"action"),Object(j.jsx)("td",{id:"time",children:e[3]},"time")]},e[0])}))]})})}function D(e){var t,n=Object(u.a)(y);try{for(n.s();!(t=n.n()).done;){if(t.value.id===e)return!0}}catch(c){n.e(c)}finally{n.f()}return!1}return Object(c.useEffect)((function(){console.log("Update today date "+r)}),[r]),Object(c.useEffect)((function(){function t(){return(t=Object(o.a)(Object(s.a)().mark((function t(){var n,c,r,i,o,u,d;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:h.c.dismiss(),console.log("Wait for sheet");case 2:if(e.doc.isOpen()){t.next=8;break}return console.log("check"),t.next=6,x(1);case 6:t.next=2;break;case 8:return console.log("done"),n=new Date,t.next=12,e.doc.sheetsByDate(n);case 12:if(c=t.sent){t.next=21;break}return(r=g).autoClose=3e3,r.type=h.c.TYPE.WARNING,h.c.warning(k.reloadPage,g),r.type=h.c.TYPE.ERROR,h.c.error(k.noSheet,g),t.abrupt("return");case 21:return i=null,e.doc.getCachedList().has(c.header.id.toString())||(g.autoClose=!1,i=h.c.info(k.loading,g)),o=c.sheet,u=c.date,t.next=28,e.doc.readList(c.header.id);case 28:console.log("tS"),console.log(o.title),a(u),i&&((d=g).type=h.c.TYPE.SUCCESS,d.autoClose=3e3,d.render=k.loaded,h.c.update(i,d));case 32:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e]),Object(c.useEffect)((function(){function t(e){return n.apply(this,arguments)}function n(){return(n=Object(o.a)(Object(s.a)().mark((function t(n){var c,r,a;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("handling scanning "+n),c=(new Date).toLocaleTimeString("en-US",{hour12:!0,hour:"numeric",minute:"numeric"}),t.next=4,e.doc.getStudent(n);case 4:if(r=t.sent){t.next=8;break}return h.c.error(k.noStudent,g),t.abrupt("return");case 8:if(console.log("Student ID: "+n+" Idx:  "+r.idx),a=null,null!=r.checkIn.valueType){t.next=16;break}r.checkIn.value=c,a="Check In",h.c.success(k.checkIn.format(r.name.value,c),g),t.next=24;break;case 16:if(null!=r.checkOut.valueType){t.next=22;break}r.checkOut.value=c,a="Check Out",h.c.success(k.checkOut.format(r.name.value,c),g),t.next=24;break;case 22:return h.c.warn(k.alreadyDone.format(r.name.value),g),t.abrupt("return");case 24:return console.log(a+" "+c),i=[r.name.value,a,c],C.push([I].concat(Object(l.a)(i))),C.length>5&&C.shift(),I+=1,t.next=28,e.doc.updateCell();case 28:w=!0;case 29:case"end":return t.stop()}var i}),t)})))).apply(this,arguments)}var c=setInterval(Object(o.a)(Object(s.a)().mark((function e(){var n,r,a;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=(new Date).getTime(),r=(new Date).toLocaleTimeString("en-US",{hour12:!0,hour:"numeric",minute:"numeric",second:"numeric"}),p(r);y.length>0&&n-y[0].tick>5e3;)y.shift();case 4:if(!(S.length>0)){e.next=14;break}if(a=S.shift(),!(n-a.tick>1e3||D(a.id))){e.next=8;break}return e.abrupt("continue",4);case 8:return y.push(a),e.next=11,t(a.id);case 11:return e.abrupt("break",14);case 14:return e.abrupt("return",(function(){return clearInterval(c)}));case 15:case"end":return e.stop()}}),e)}))),200)}),[]),Object(j.jsxs)("div",{id:"scan",children:[Object(j.jsxs)("div",{id:"title",children:[Object(j.jsx)("img",{id:"logo",src:m,alt:"SVKS"}),Object(j.jsx)("h1",{children:" SVKS Check In/Out "})]}),Object(j.jsxs)("div",{id:"clock",children:[r," ",f]}),Object(j.jsxs)("div",{id:"contents",children:[Object(j.jsx)("div",{id:"reader",children:Object(j.jsx)(O,{onScan:function(e){return v.apply(this,arguments)},periodic:function(){var e=w;return w=!1,e}})}),Object(j.jsxs)("div",{id:"recent",children:[Object(j.jsx)("h2",{children:"Recent Check In/Out"}),Object(j.jsx)(E,{})]})]})]})},D=n(132),T=n.n(D),A=n(469),R=n(246),L=r.a.forwardRef((function(e,t){return Object(j.jsx)("div",{className:"toPrint",ref:t,style:{width:"auto"},children:e.children})}));var N=function(e){var t=Object(c.useState)(""),n=Object(d.a)(t,2),r=n[0],a=n[1],i=Object(c.useState)([]),b=Object(d.a)(i,2),f=b[0],p=b[1],O=Object(c.useState)([]),S=Object(d.a)(O,2),y=S[0],C=S[1],w=Object(A.a)(r,50),I=Object(d.a)(w,1)[0],E=Object(c.useState)([]),D=Object(d.a)(E,2),N=D[0],K=D[1],P=Object(c.useState)([]),F=Object(d.a)(P,2),M=F[0],B=F[1],U=Object(c.useState)([]),_=Object(d.a)(U,2),G=_[0],J=_[1],V=Object(c.useState)(!1),Y=Object(d.a)(V,2),Z=Y[0],H=Y[1],W=Object(c.useState)(!1),X=Object(d.a)(W,2),Q=X[0],z=X[1],q=Object(c.useState)(0),$=Object(d.a)(q,2),ee=$[0],te=$[1],ne=Object(c.useRef)(),ce=Object(R.useReactToPrint)({content:function(){return ne.current}});function re(){return(re=Object(o.a)(Object(s.a)().mark((function e(){var t,n,c,r,a;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[],n=0;n<y.length;n++)y[n]&&"x"===y[n].toLowerCase()&&null!=f[n].id&&(c=f[n],r="".concat(c.name,":  ").concat(c.id),a={text:r,name:c.name,id:c.id.toString()},t.push(a));B([].concat(Object(l.a)(M),t));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(c.useEffect)((function(){function t(){return(t=Object(o.a)(Object(s.a)().mark((function t(){var n,c,r,a,i,o,u,d,l,b,f,j,O;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:h.c.dismiss();case 1:if(e.doc.isOpen()){t.next=6;break}return t.next=4,x(.1);case 4:t.next=1;break;case 6:return t.next=8,e.doc.findMostRecentSheet();case 8:if(n=t.sent){t.next=14;break}return(c=g).autoClose=3e3,h.c.error(k.failedToOpen,c),t.abrupt("return");case 14:return r=e.doc.getCachedList(),a=null,r.has(n.header.id.toString())&&r.has(n.header.name.toString())&&(!n.header.print||n.header.print in r)||(console.log("Data should be loaded"),(i=g).autoClose=!1,a=h.c.info(k.loading,i)),console.log(n.date),o=n.header.id,t.next=21,e.doc.readList(o);case 21:return u=t.sent,d=n.header.name,t.next=25,e.doc.readList(d);case 25:for(l=t.sent,b=[],f=0;f<Math.min(u.length,l.length);f++)b.push({id:u[f],name:l[f]});if(p(b),!(j=n.header.print)){t.next=36;break}return t.t0=C,t.next=34,e.doc.readList(j);case 34:t.t1=t.sent,(0,t.t0)(t.t1);case 36:console.log("Sheet read "+b.length),a&&((O=g).type=h.c.TYPE.SUCCESS,O.render=k.succeededToOpen,O.autoClose=3e3,h.c.update(a,O));case 38:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(c.useEffect)((function(){function e(e){return t.apply(this,arguments)}function t(){return(t=Object(o.a)(Object(s.a)().mark((function e(t){var n,c,r,a,i,o;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],c=Object(u.a)(f),e.prev=2,c.s();case 4:if((r=c.n()).done){e.next=11;break}if(a=r.value,!(n.length>4)){e.next=8;break}return e.abrupt("break",11);case 8:(a.id&&a.id.toString().includes(t)||a.name&&a.name.toString().includes(t))&&(i="".concat(a.name,":  ").concat(a.id),o={text:i,name:a.name,id:a.id.toString()},n.push(o));case 9:e.next=4;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),c.e(e.t0);case 16:return e.prev=16,c.f(),e.finish(16);case 19:return e.abrupt("return",n);case 20:case"end":return e.stop()}}),e,null,[[2,13,16,19]])})))).apply(this,arguments)}function n(){return(n=Object(o.a)(Object(s.a)().mark((function t(){var n;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!I){t.next=7;break}return t.next=3,e(I);case 3:(n=t.sent).length>0&&K(n),t.next=8;break;case 7:K([]);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){n.apply(this,arguments)}()}),[I,f]),Object(c.useEffect)((function(){H(y.length>0)}),[y]),Object(c.useEffect)((function(){z(N.length>0)}),[N]),Object(c.useEffect)((function(){var e=M.length;if(e>v){var t=ee*v,n=Math.min(v,e-t);J(M.slice(t,t+n))}else J(M),te(0)}),[M,ee]),Object(j.jsxs)("div",{id:"print",children:[Object(j.jsxs)("div",{id:"title",children:[Object(j.jsx)("img",{id:"logo",src:m,alt:"SVKS"}),Object(j.jsx)("h1",{children:" Print QR Codes "})]}),Object(j.jsxs)("div",{id:"printContents",children:[Object(j.jsx)("input",{id:"search",placeholder:"Search for student or enter a number...",value:r,onChange:function(e){a(e.target.value)}}),N.map((function(e){return Object(j.jsx)("div",{id:"searchResult",onClick:function(){var t=!0;M.map((function(n){return n.id===e.id&&(t=!1),""})),t&&B([].concat(Object(l.a)(M),[e]))},children:Object(j.jsxs)("h4",{children:[" ",e.text," "]})},e.id)}))]}),G.length>0&&Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("div",{id:"selected",children:G.map((function(e){return Object(j.jsxs)("div",{id:"selectedItem",children:[Object(j.jsx)(T.a,{size:100,value:e.id}),Object(j.jsxs)("p",{id:"qrName",children:[" ",e.text," "]}),Object(j.jsx)("button",{id:"deleteButton",onClick:function(){B(M.filter((function(t){return parseInt(t.id)!==parseInt(e.id)})))},children:" X "})]},e.id)}))}),Object(j.jsx)(L,{ref:ne,children:function(){for(var e=[],t=0;t<M.length;t+=12){var n=Math.min(12,M.length-t);e.push(M.slice(t,t+n))}return e.map((function(e){return Object(j.jsx)("div",{id:"qrList",children:e.map((function(e){return Object(j.jsxs)("div",{id:"qrCode",children:[Object(j.jsx)(T.a,{size:160,value:e.id}),Object(j.jsx)("p",{id:"qrName",children:e.text})]},e.id)}))})}))}()})]}),M.length>v&&Object(j.jsxs)("div",{id:"pageControl",hidden:M.length<=v,children:[Object(j.jsx)("button",{id:"prevPage",onClick:function(){ee>0&&te(ee-1)},children:" << "}),Object(j.jsxs)("p",{id:"pageNum",children:[" ",ee+1," "]}),Object(j.jsx)("button",{id:"nextPage",onClick:function(){M.length>(ee+1)*v&&te(ee+1)},children:" >> "})]}),Object(j.jsx)("button",{id:"printButton",hidden:0===G.length,onClick:ce,children:"Print codes"}),Object(j.jsx)("button",{id:"selectSearched",hidden:!Q,onClick:function(){for(var e=[],t=function(){var t=N[n],c=!0;M.map((function(e){return e.id===t.id&&(c=!1),""})),c&&e.push(t)},n=0;n<N.length;n++)t();B([].concat(Object(l.a)(M),e))},children:"Select all search results"}),Object(j.jsx)("button",{id:"selectAll",onClick:function(){var e=[];B([]);var t,n=new Set,c=Object(u.a)(f);try{for(c.s();!(t=c.n()).done;){var r=t.value;if(null!=r.id&&0!==r.id.length&&null!=r.name&&!n.has(r.id)){console.log(r);var a={text:"".concat(r.name,":  ").concat(r.id),name:r.name,id:r.id.toString()};e.push(a),n.add(r.id)}}}catch(i){c.e(i)}finally{c.f()}B(e)},children:"Select all"}),Object(j.jsx)("button",{id:"selectMarked",hidden:!Z,onClick:function(){return re.apply(this,arguments)},children:"Print codes for marked students."}),Object(j.jsx)("button",{id:"removeAll",hidden:!M.length>0,onClick:function(){B([])},children:"Remove all"})]})},K=n(133),P=new Set;function F(){return(new Date).toLocaleTimeString("en-US",{hour12:!0,hour:"numeric",minute:"numeric"})}var M,B=function(e){var t=Object(c.useState)(""),n=Object(d.a)(t,2),r=n[0],a=n[1],i=Object(c.useState)([]),l=Object(d.a)(i,2),b=l[0],f=l[1],p=Object(A.a)(r,50),O=Object(d.a)(p,1)[0],v=Object(c.useState)([]),S=Object(d.a)(v,2),y=S[0],C=S[1],w=Object(c.useState)({id:-1}),I=Object(d.a)(w,2),E=I[0],D=I[1],T=Object(c.useState)((new Date).toLocaleDateString()),R=Object(d.a)(T,2),L=R[0],N=R[1],M=Object(c.useState)(""),B=Object(d.a)(M,2),U=B[0],_=B[1];Object(c.useEffect)((function(){function t(){return(t=Object(o.a)(Object(s.a)().mark((function t(){var n,c,r,a,i,o,u,d,l,b,j,p,O;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:h.c.dismiss();case 1:if(e.doc.isOpen()){t.next=6;break}return t.next=4,x(.1);case 4:t.next=1;break;case 6:return n=new Date,t.next=9,e.doc.sheetsByDate(n);case 9:if(c=t.sent){t.next=15;break}return(r=g).autoClose=3e3,h.c.error(k.failedToOpen,r),t.abrupt("return");case 15:return a=e.doc.getCachedList(),i=null,a.has(c.header.id.toString())&&a.has(c.header.name.toString())||(console.log("Data should be loaded"),(o=g).autoClose=!1,i=h.c.info(k.loading,o)),console.log(c.date),u=c.header.id,t.next=22,e.doc.readList(u);case 22:return d=t.sent,l=c.header.name,t.next=26,e.doc.readList(l);case 26:for(b=t.sent,j=[],p=0;p<Math.min(d.length,b.length);p++)j.push({id:d[p],name:b[p]});f(j),console.log("Sheet read "+j.length),i&&((O=g).type=h.c.TYPE.SUCCESS,O.autoClose=3e3,O.render=k.succeededToOpen,h.c.update(i,O)),N(c.date);case 33:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return function(){t.apply(this,arguments)}(),function(){return h.c.dismiss()}}),[]),Object(c.useEffect)((function(){function e(e){return t.apply(this,arguments)}function t(){return(t=Object(o.a)(Object(s.a)().mark((function e(t){var n,c,r,a,i,o;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],c=Object(u.a)(b),e.prev=2,c.s();case 4:if((r=c.n()).done){e.next=11;break}if(a=r.value,!(n.length>4)){e.next=8;break}return e.abrupt("break",11);case 8:(a.id&&a.id.toString().includes(t)||a.name&&a.name.toString().includes(t))&&(i="".concat(a.id,": ").concat(a.name),o={id:a.id,name:a.name,text:i},n.push(o),P.add(a.id));case 9:e.next=4;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),c.e(e.t0);case 16:return e.prev=16,c.f(),e.finish(16);case 19:return e.abrupt("return",n);case 20:case"end":return e.stop()}}),e,null,[[2,13,16,19]])})))).apply(this,arguments)}function n(){return(n=Object(o.a)(Object(s.a)().mark((function t(){var n;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!O){t.next=7;break}return t.next=3,e(O);case 3:(n=t.sent).length>0?C(n):(console.log("No matching student"),C([])),t.next=9;break;case 7:console.log("No matching student"),C([]);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){n.apply(this,arguments)}()}),[O,b]),Object(c.useEffect)((function(){var e=setInterval(Object(o.a)(Object(s.a)().mark((function t(){var n;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(new Date).toLocaleTimeString("en-US",{hour12:!0,hour:"numeric",minute:"numeric",second:"numeric"}),_(n),t.abrupt("return",(function(){return clearInterval(e)}));case 3:case"end":return t.stop()}}),t)}))),200)}),[]);var G=function(){var t=Object(o.a)(Object(s.a)().mark((function t(n){var c;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.doc.getStudent(n);case 2:c=t.sent,console.log("Select "+E.id+" "+n),console.log(E),E&&E.id&&E.id===n?(console.log("Deselect"),D({id:-1})):(console.log("Selected"),console.log(c),D(Object(K.a)(Object(K.a)({},c),{},{id:n})));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),J=function(t){var n,c,r,a;r=a=!1,n="Check In",c="Check Out";var i=E.id!==t.id;return i||(E.checkIn.valueType&&(n="Check In: "+E.checkIn.formattedValue,r=!0),E.checkOut.valueType&&(c="Check Out: "+E.checkOut.formattedValue,a=!0)),Object(j.jsxs)("div",{children:[Object(j.jsxs)("button",{type:"button",id:"searchResult",onClick:Object(o.a)(Object(s.a)().mark((function e(){return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G(t.id);case 2:case"end":return e.stop()}}),e)}))),children:[" ",t.text," "]}),Object(j.jsxs)("div",{hidden:i,children:[Object(j.jsxs)("button",{type:"button",id:"checkInOut",disabled:r,onClick:function(){!function(t){console.log("Check in "+t);var n=F();E.checkIn.value=n,e.doc.updateCell(),h.c.success(k.checkIn.format(E.name.value,n),g)}(t.id)},children:[" ",n," "]}),Object(j.jsxs)("button",{type:"button",id:"checkInOut",disabled:a,onClick:function(){!function(t){console.log("Check out "+t);var n=F();E.checkOut.value=n,e.doc.updateCell(),h.c.success(k.checkOut.format(E.name.value,n),g)}(t.id)},children:[" ",c," "]})]})]},t.id)};return Object(j.jsxs)("div",{id:"manual",children:[Object(j.jsxs)("div",{id:"title",children:[Object(j.jsx)("img",{id:"logo",src:m,alt:"SVKS"}),Object(j.jsx)("h1",{children:" Manual Check In/Out "})]}),Object(j.jsxs)("div",{id:"clock",children:[L," ",U]}),Object(j.jsxs)("div",{id:"manualInput",children:[Object(j.jsx)("input",{id:"search",placeholder:"Search for student or enter a number...",value:r,onChange:function(e){a(e.target.value)}}),y.map((function(e){return J(e)}))]})]})},U=n(72),_=n(4),G=n(36),J=n(37),V={production:"1FqeRNFlZZ7aJdtYRmjZ1kRb2-sarN9aoTMGyu4jhGKs",development:"1FqeRNFlZZ7aJdtYRmjZ1kRb2-sarN9aoTMGyu4jhGKs"},Y=n(247),Z=n(45),H=n(264).GoogleSpreadsheet;console.log("Production mode"),M="production";var W=[{year:"numeric",month:"numeric",day:"numeric"},{year:"2-digit",month:"numeric",day:"numeric"},{year:"numeric",month:"2-digit",day:"numeric"},{year:"2-digit",month:"2-digit",day:"numeric"},{year:"numeric",month:"numeric",day:"2-digit"},{year:"2-digit",month:"numeric",day:"2-digit"},{year:"numeric",month:"2-digit",day:"2-digit"},{year:"2-digit",month:"2-digit",day:"2-digit"}];function X(e,t){var n=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),c=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate());return Math.abs(Math.floor((c-n)/864e5))}function Q(e,t){var n,c=Object(u.a)(t);try{for(c.s();!(n=c.n()).done;){if(n.value===e)return!0}}catch(r){c.e(r)}finally{c.f()}return!1}var z=function(){function e(){Object(G.a)(this,e),console.log("Create Doc class");var t=new H(V[M]);this.state={doc:t,initialized:!1,sheetInfo:{sheet:null,date:null,header:null,cachedList:{}}}}return Object(J.a)(e,[{key:"openDoc",value:function(){var e=Object(o.a)(Object(s.a)().mark((function e(){return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("try to read sheet"),e.next=3,this.state.doc.useServiceAccountAuth(Y);case 3:return console.log("Auth Done"),e.next=6,this.state.doc.loadInfo();case 6:console.log("Done"),this.state.initialized=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isOpen",value:function(){return this.state.initialized}},{key:"getCachedList",value:function(){return new Set(Object.keys(this.state.sheetInfo.cachedList))}},{key:"sheetsByTitle",value:function(){var e=Object(o.a)(Object(s.a)().mark((function e(t){return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.state.doc.sheetsByTitle[t];case 2:return this.state.sheetInfo.sheet=e.sent,this.state.sheetInfo.date=t,e.abrupt("return",this.state.sheetInfo);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sheetsByDate",value:function(){var e=Object(o.a)(Object(s.a)().mark((function e(t){var n,c,r,a,i,o,u,d,l,h,b;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0,c=W;case 1:if(!(n<c.length)){e.next=11;break}if(r=c[n],a=t.toLocaleDateString("en-US",r),!this.state.sheetInfo.date||a!==this.state.sheetInfo.date){e.next=8;break}return console.log("Found "+a),console.log(this.state.sheetInfo),e.abrupt("return",this.state.sheetInfo);case 8:n++,e.next=1;break;case 11:i=!1,o=0,u=W;case 13:if(!(o<u.length)){e.next=27;break}return d=u[o],l=t.toLocaleDateString("en-US",d),e.next=18,this.state.doc.sheetsByTitle[l];case 18:if(!(h=e.sent)){e.next=24;break}return this.state.sheetInfo.date=l,this.state.sheetInfo.sheet=h,i=!0,e.abrupt("break",27);case 24:o++,e.next=13;break;case 27:if(i){e.next=29;break}return e.abrupt("return",null);case 29:return console.log("Found sheet "+this.state.sheetInfo.sheet),e.next=32,this.state.sheetInfo.sheet.loadCells("A1:Z1");case 32:return b=this.createHeader(this.state.sheetInfo.sheet),console.log(b),this.state.sheetInfo.header=b,e.abrupt("return",this.state.sheetInfo);case 36:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.sheetInfo.sheet,t=null,n=null,c=null,r=null,a=null,i=null;if(!e)return{};for(var s=0;s<Math.min(26,e.columnCount);s++){var o=e.getCell(0,s);null!=o.valueType&&(n=Q(o.value,Z.name)?s:n,t=Q(o.value,Z.id)?s:t,c=Q(o.value,Z.class)?s:c,r=Q(o.value,Z.checkIn)?s:r,a=Q(o.value,Z.checkOut)?s:a,i=Q(o.value,Z.print)?s:i)}return{id:t,name:n,class:c,checkIn:r,checkOut:a,print:i}}},{key:"readList",value:function(){var e=Object(o.a)(Object(s.a)().mark((function e(t){var n,c,r,a,i,o,u,d,l,h,b,f,j=arguments;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=j.length>1&&void 0!==j[1]?j[1]:this.state.sheetInfo.sheet,!(t in this.state.sheetInfo.cachedList)){e.next=3;break}return e.abrupt("return",this.state.sheetInfo.cachedList[t]);case 3:if(c=0,r=100,a=[],n){e.next=8;break}return e.abrupt("return",[]);case 8:i=null,o=n.rowCount;case 10:if(!(c<o-1)){e.next=23;break}return u=Math.min(o-c,r),d=String.fromCharCode(65+t)+(c+1)+":"+String.fromCharCode(65+t)+(c+u),console.log(toString(t)+" "+d),e.next=16,n.loadCells(d);case 16:for(l=0,h=0;h<r;h++)b=n.getCell(c+h,t),f=null,null==b.valueType?l++:(f=b.value,i=c+h),a.push(f);if(l!==r){e.next=20;break}return e.abrupt("break",23);case 20:c+=u,e.next=10;break;case 23:return a[0]="",a=a.slice(0,i+1),this.state.sheetInfo.cachedList[t]=a,e.abrupt("return",a);case 27:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getStudent",value:function(){var e=Object(o.a)(Object(s.a)().mark((function e(t){var n,c,r,a,i,o,u,d,l;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.state.sheetInfo.sheet){e.next=3;break}return e.abrupt("return",null);case 3:return c=t,e.next=6,this.findStudentRow(c);case 6:if(r=e.sent){e.next=9;break}return e.abrupt("return",null);case 9:return a=this.state.sheetInfo.header,console.log("Student ID: "+c+" Index:"+r),i=String.fromCharCode(65)+r+":"+String.fromCharCode(90)+r,console.log(i),e.next=15,n.loadCells(i);case 15:return o=r-1,console.log("Get Cell "+o+" "+a.name),u=n.getCell(o,a.name),d=n.getCell(o,a.checkIn),l=n.getCell(o,a.checkOut),e.abrupt("return",{idx:o,name:u,checkIn:d,checkOut:l});case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateCell",value:function(){var e=Object(o.a)(Object(s.a)().mark((function e(){var t;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state.sheetInfo.sheet){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,t.saveUpdatedCells();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"findStudentRow",value:function(){var e=Object(o.a)(Object(s.a)().mark((function e(t){var n,c;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.readList(this.state.sheetInfo.header.id);case 2:n=e.sent,console.log("finding student row "+n.length),c=0;case 5:if(!(c<n.length)){e.next=11;break}if(!n[c]||n[c]!==t){e.next=8;break}return e.abrupt("return",c+1);case 8:c++,e.next=5;break;case 11:return e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"findMostRecentSheet",value:function(){var e=Object(o.a)(Object(s.a)().mark((function e(){var t,n,c;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=new Date,n=new Date;case 2:if(!(X(n,t)<40)){e.next=11;break}return e.next=5,this.sheetsByDate(t);case 5:if(!(c=e.sent)){e.next=8;break}return e.abrupt("return",c);case 8:t.setDate(t.getDate()-1),e.next=2;break;case 11:return e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),q=new z;var $=function(){return Object(c.useEffect)((function(){function e(){return(e=Object(o.a)(Object(s.a)().mark((function e(){return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Initialize app"),console.log(Object({NODE_ENV:"production",PUBLIC_URL:"/checkin",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).APP_NAME),console.log(Object({NODE_ENV:"production",PUBLIC_URL:"/checkin",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).APP_VERSION),q.openDoc();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(j.jsxs)(U.a,{children:[Object(j.jsx)("div",{children:Object(j.jsx)("nav",{id:"nav",children:Object(j.jsx)("table",{id:"nav",children:Object(j.jsx)("tbody",{children:Object(j.jsxs)("tr",{children:[Object(j.jsx)("td",{id:"nav_item",children:Object(j.jsx)(U.b,{to:"/",children:Object(j.jsx)("button",{id:"nav_scan",children:"Scan"})})}),Object(j.jsx)("td",{id:"nav_item",children:Object(j.jsx)(U.b,{to:"/manual",children:Object(j.jsx)("button",{id:"nav_manual",children:"Manual"})})}),Object(j.jsx)("td",{id:"nav_item",children:Object(j.jsx)(U.b,{to:"/print",children:Object(j.jsx)("button",{id:"nav_print",children:"Print"})})})]})})})})}),Object(j.jsx)("hr",{}),Object(j.jsxs)("div",{className:"App",children:[Object(j.jsxs)(_.c,{children:[Object(j.jsx)(_.a,{path:"/",element:Object(j.jsx)(E,{doc:q})}),Object(j.jsx)(_.a,{path:"/print",element:Object(j.jsx)(N,{doc:q})}),Object(j.jsx)(_.a,{path:"/manual",element:Object(j.jsx)(B,{doc:q})})]}),Object(j.jsx)(h.a,{position:"bottom-center",autoClose:3e3,hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,draggable:!0,pauseOnHover:!0,pauseOnFocusLoss:!1,transition:h.b,icon:!1}),Object(j.jsx)("h2",{children:"For SVKS student volunteer use ONLY."})]})]})},ee=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,470)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),a(e),i(e)}))};i.a.render(Object(j.jsx)(r.a.StrictMode,{children:Object(j.jsx)($,{})}),document.getElementById("root")),ee()},92:function(e,t,n){}},[[468,1,2]]]);
//# sourceMappingURL=main.f3e9056a.chunk.js.map